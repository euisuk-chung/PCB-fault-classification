2021-06-15 01:49:29,557 : START
2021-06-15 01:49:29,565 : Global Device: cuda:1
2021-06-15 01:49:29,565 : Parsed Args: Namespace(base_dir='/repo/course/sem21_01/PCB-fault-classification/', base_model='plain_resnet101', batch_size=16, ckpt_path='/repo/course/sem21_01/PCB-fault-classification/ckpt/', cuda=True, data_type='original', device_index=1, epochs=50, fold_k=1, label_dir='/repo/course/sem21_01/PCB-fault-classification/label.csv', learning_rate=0.003, lr_type='multi', mode='train', model_index=52, patience=10, pretrained=False, pretrained_weights_dir='/repo/course/sem21_01/PCB-fault-classification/pretrained_model', seed=227182, test_ratio=0.2, threshold=0.0, tta=False, val_ratio=0.15, verbose=20, voting='hard')
2021-06-15 01:49:29,574 : Trainset(train+val) length: 2400, Testset length: 600
2021-06-15 01:49:29,640 : Trainset length: 2040, Valset length: 360
2021-06-15 01:49:30,141 : Not using pretrained model.
2021-06-15 01:49:33,779 : Training on Fold (1/1)
2021-06-15 01:49:33,786 : 
                    ---------------------------------------------------------------------------
                        TRAINING INFO
                            Loss function : BCEWithLogitsLoss()
                            Optimizer     : RAdam (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.003
    lr: 0.003
    weight_decay: 0.0001
)
                            LR_Scheduler  : <torch.optim.lr_scheduler.MultiStepLR object at 0x7f362bb671d0>
                    ---------------------------------------------------------------------------
2021-06-15 01:49:33,786 : Training begins... Epochs = 50
2021-06-15 01:49:33,786 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 1th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 01:50:56,451 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 1th epoch
        Time taken      : 1m 22.66s
        Training Loss   : 0.713469  |  Training Acc   : 55.0082%
        Validation Loss : 0.684021  |  Validation Acc : 59.4907%
===========================================================================

2021-06-15 01:50:56,451 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 2th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 01:52:23,492 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 2th epoch
        Time taken      : 1m 27.04s
        Training Loss   : 0.681795  |  Training Acc   : 57.4592%
        Validation Loss : 0.673851  |  Validation Acc : 60.0926%
===========================================================================

2021-06-15 01:52:23,493 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 3th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 01:53:45,625 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 3th epoch
        Time taken      : 1m 22.13s
        Training Loss   : 0.681813  |  Training Acc   : 57.5245%
        Validation Loss : 0.678070  |  Validation Acc : 59.2593%
===========================================================================

2021-06-15 01:53:45,625 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 4th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 01:55:07,939 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 4th epoch
        Time taken      : 1m 22.31s
        Training Loss   : 0.682317  |  Training Acc   : 56.9771%
        Validation Loss : 0.671753  |  Validation Acc : 60.0463%
===========================================================================

2021-06-15 01:55:07,939 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 5th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 01:56:31,242 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 5th epoch
        Time taken      : 1m 23.30s
        Training Loss   : 0.679596  |  Training Acc   : 57.8513%
        Validation Loss : 0.669145  |  Validation Acc : 59.6759%
===========================================================================

2021-06-15 01:56:31,243 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 6th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 01:57:53,005 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 6th epoch
        Time taken      : 1m 21.76s
        Training Loss   : 0.681555  |  Training Acc   : 57.3366%
        Validation Loss : 0.679250  |  Validation Acc : 59.8611%
===========================================================================

2021-06-15 01:57:53,005 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 7th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 01:59:14,420 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 7th epoch
        Time taken      : 1m 21.41s
        Training Loss   : 0.683436  |  Training Acc   : 57.4183%
        Validation Loss : 0.679596  |  Validation Acc : 59.8148%
===========================================================================

2021-06-15 01:59:14,421 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 8th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 02:00:37,154 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 8th epoch
        Time taken      : 1m 22.73s
        Training Loss   : 0.680580  |  Training Acc   : 58.0065%
        Validation Loss : 0.672416  |  Validation Acc : 60.0463%
===========================================================================

2021-06-15 02:00:37,154 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 9th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 02:02:02,837 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 9th epoch
        Time taken      : 1m 25.68s
        Training Loss   : 0.679031  |  Training Acc   : 58.0147%
        Validation Loss : 0.675209  |  Validation Acc : 59.9074%
===========================================================================

2021-06-15 02:02:02,838 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 10th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 02:03:26,184 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 10th epoch
        Time taken      : 1m 23.35s
        Training Loss   : 0.677874  |  Training Acc   : 58.1373%
        Validation Loss : 0.669216  |  Validation Acc : 60.2778%
===========================================================================

2021-06-15 02:03:26,184 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 11th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 02:04:48,498 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 11th epoch
        Time taken      : 1m 22.31s
        Training Loss   : 0.678412  |  Training Acc   : 58.0719%
        Validation Loss : 0.672970  |  Validation Acc : 59.9537%
===========================================================================

2021-06-15 02:04:48,499 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 12th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 02:06:10,097 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 12th epoch
        Time taken      : 1m 21.60s
        Training Loss   : 0.676524  |  Training Acc   : 58.1618%
        Validation Loss : 0.669913  |  Validation Acc : 60.3241%
===========================================================================

2021-06-15 02:06:10,097 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 13th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 02:07:31,406 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 13th epoch
        Time taken      : 1m 21.31s
        Training Loss   : 0.677179  |  Training Acc   : 58.2271%
        Validation Loss : 0.674334  |  Validation Acc : 59.8148%
===========================================================================

2021-06-15 02:07:31,406 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 14th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 02:08:52,707 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 14th epoch
        Time taken      : 1m 21.30s
        Training Loss   : 0.679408  |  Training Acc   : 58.1618%
        Validation Loss : 0.671165  |  Validation Acc : 59.7685%
===========================================================================

2021-06-15 02:08:52,708 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 15th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 02:10:14,230 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 15th epoch
        Time taken      : 1m 21.52s
        Training Loss   : 0.678663  |  Training Acc   : 57.9984%
        Validation Loss : 0.670943  |  Validation Acc : 59.8611%
===========================================================================

2021-06-15 02:10:14,231 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 16th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 02:11:35,764 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 16th epoch
        Time taken      : 1m 21.53s
        Training Loss   : 0.679310  |  Training Acc   : 57.9575%
        Validation Loss : 0.673356  |  Validation Acc : 59.6296%
===========================================================================

2021-06-15 02:11:35,765 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 17th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 02:12:57,558 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 17th epoch
        Time taken      : 1m 21.79s
        Training Loss   : 0.672806  |  Training Acc   : 58.4641%
        Validation Loss : 0.637867  |  Validation Acc : 66.3426%
===========================================================================

2021-06-15 02:12:57,558 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 18th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 02:14:20,102 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 18th epoch
        Time taken      : 1m 22.54s
        Training Loss   : 0.655861  |  Training Acc   : 59.2810%
        Validation Loss : 0.607768  |  Validation Acc : 62.5926%
===========================================================================

2021-06-15 02:14:20,102 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 19th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 02:15:42,078 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 19th epoch
        Time taken      : 1m 21.98s
        Training Loss   : 0.562796  |  Training Acc   : 68.1781%
        Validation Loss : 0.493974  |  Validation Acc : 76.3426%
===========================================================================

2021-06-15 02:15:42,078 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 20th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 02:17:03,959 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 20th epoch
        Time taken      : 1m 21.88s
        Training Loss   : 0.475648  |  Training Acc   : 75.3840%
        Validation Loss : 0.321905  |  Validation Acc : 84.3981%
===========================================================================

2021-06-15 02:17:03,960 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 21th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:18:25,586 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 21th epoch
        Time taken      : 1m 21.63s
        Training Loss   : 0.387634  |  Training Acc   : 80.6699%
        Validation Loss : 0.362430  |  Validation Acc : 83.0093%
===========================================================================

2021-06-15 02:18:25,586 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 22th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:19:47,009 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 22th epoch
        Time taken      : 1m 21.42s
        Training Loss   : 0.364202  |  Training Acc   : 82.8758%
        Validation Loss : 0.307341  |  Validation Acc : 84.2130%
===========================================================================

2021-06-15 02:19:47,009 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 23th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:21:09,399 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 23th epoch
        Time taken      : 1m 22.39s
        Training Loss   : 0.434976  |  Training Acc   : 80.0654%
        Validation Loss : 0.314143  |  Validation Acc : 85.8796%
===========================================================================

2021-06-15 02:21:09,399 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 24th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:22:30,534 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 24th epoch
        Time taken      : 1m 21.13s
        Training Loss   : 0.333971  |  Training Acc   : 84.8529%
        Validation Loss : 0.308898  |  Validation Acc : 85.6944%
===========================================================================

2021-06-15 02:22:30,534 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 25th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:23:52,187 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 25th epoch
        Time taken      : 1m 21.65s
        Training Loss   : 0.331584  |  Training Acc   : 84.9837%
        Validation Loss : 0.309727  |  Validation Acc : 86.8981%
===========================================================================

2021-06-15 02:23:52,187 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 26th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:25:13,718 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 26th epoch
        Time taken      : 1m 21.53s
        Training Loss   : 0.338659  |  Training Acc   : 84.6487%
        Validation Loss : 0.302891  |  Validation Acc : 86.5741%
===========================================================================

2021-06-15 02:25:13,719 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 27th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:26:35,477 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 27th epoch
        Time taken      : 1m 21.76s
        Training Loss   : 0.354011  |  Training Acc   : 83.9624%
        Validation Loss : 0.317538  |  Validation Acc : 85.0000%
===========================================================================

2021-06-15 02:26:35,478 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 28th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:27:58,038 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 28th epoch
        Time taken      : 1m 22.56s
        Training Loss   : 0.306796  |  Training Acc   : 85.8252%
        Validation Loss : 0.291623  |  Validation Acc : 87.2685%
===========================================================================

2021-06-15 02:27:58,038 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 29th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:29:21,763 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 29th epoch
        Time taken      : 1m 23.72s
        Training Loss   : 0.314874  |  Training Acc   : 85.7680%
        Validation Loss : 0.292425  |  Validation Acc : 85.7407%
===========================================================================

2021-06-15 02:29:21,763 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 30th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 02:30:45,476 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 30th epoch
        Time taken      : 1m 23.71s
        Training Loss   : 0.310878  |  Training Acc   : 86.2908%
        Validation Loss : 0.269858  |  Validation Acc : 88.2407%
===========================================================================

2021-06-15 02:30:45,476 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 31th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:32:09,393 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 31th epoch
        Time taken      : 1m 23.92s
        Training Loss   : 0.285132  |  Training Acc   : 87.8431%
        Validation Loss : 0.274733  |  Validation Acc : 87.3148%
===========================================================================

2021-06-15 02:32:09,393 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 32th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:33:30,920 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 32th epoch
        Time taken      : 1m 21.53s
        Training Loss   : 0.321025  |  Training Acc   : 85.8824%
        Validation Loss : 0.269313  |  Validation Acc : 88.4259%
===========================================================================

2021-06-15 02:33:30,921 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 33th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:34:52,756 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 33th epoch
        Time taken      : 1m 21.83s
        Training Loss   : 0.289663  |  Training Acc   : 87.6961%
        Validation Loss : 0.263825  |  Validation Acc : 88.9815%
===========================================================================

2021-06-15 02:34:52,756 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 34th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:36:14,526 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 34th epoch
        Time taken      : 1m 21.77s
        Training Loss   : 0.274216  |  Training Acc   : 88.5784%
        Validation Loss : 0.248047  |  Validation Acc : 90.3704%
===========================================================================

2021-06-15 02:36:14,526 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 35th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:37:35,766 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 35th epoch
        Time taken      : 1m 21.24s
        Training Loss   : 0.272370  |  Training Acc   : 88.3497%
        Validation Loss : 0.252316  |  Validation Acc : 89.6759%
===========================================================================

2021-06-15 02:37:35,767 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 36th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:38:57,552 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 36th epoch
        Time taken      : 1m 21.79s
        Training Loss   : 0.268311  |  Training Acc   : 88.7500%
        Validation Loss : 0.245251  |  Validation Acc : 89.6759%
===========================================================================

2021-06-15 02:38:57,553 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 37th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:40:20,438 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 37th epoch
        Time taken      : 1m 22.89s
        Training Loss   : 0.280470  |  Training Acc   : 87.9657%
        Validation Loss : 0.254126  |  Validation Acc : 89.8611%
===========================================================================

2021-06-15 02:40:20,438 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 38th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:41:42,636 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 38th epoch
        Time taken      : 1m 22.20s
        Training Loss   : 0.324812  |  Training Acc   : 89.0114%
        Validation Loss : 0.249884  |  Validation Acc : 89.5370%
===========================================================================

2021-06-15 02:41:42,636 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 39th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:43:05,378 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 39th epoch
        Time taken      : 1m 22.74s
        Training Loss   : 0.298744  |  Training Acc   : 87.4918%
        Validation Loss : 0.262978  |  Validation Acc : 89.4907%
===========================================================================

2021-06-15 02:43:05,378 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 40th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:44:28,282 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 40th epoch
        Time taken      : 1m 22.90s
        Training Loss   : 0.269735  |  Training Acc   : 88.7745%
        Validation Loss : 0.265778  |  Validation Acc : 89.6296%
===========================================================================

2021-06-15 02:44:28,282 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_40.pth
2021-06-15 02:44:28,539 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 41th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:45:51,070 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 41th epoch
        Time taken      : 1m 22.53s
        Training Loss   : 0.262677  |  Training Acc   : 89.4281%
        Validation Loss : 0.240224  |  Validation Acc : 90.3241%
===========================================================================

2021-06-15 02:45:51,070 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 42th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:47:13,996 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 42th epoch
        Time taken      : 1m 22.93s
        Training Loss   : 0.309861  |  Training Acc   : 86.4052%
        Validation Loss : 0.273598  |  Validation Acc : 88.4722%
===========================================================================

2021-06-15 02:47:13,996 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_42.pth
2021-06-15 02:47:14,257 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 43th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:48:36,963 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 43th epoch
        Time taken      : 1m 22.71s
        Training Loss   : 0.289834  |  Training Acc   : 88.1209%
        Validation Loss : 0.259792  |  Validation Acc : 89.4444%
===========================================================================

2021-06-15 02:48:36,963 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 44th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:49:59,804 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 44th epoch
        Time taken      : 1m 22.84s
        Training Loss   : 0.266308  |  Training Acc   : 89.2565%
        Validation Loss : 0.268719  |  Validation Acc : 89.2593%
===========================================================================

2021-06-15 02:49:59,805 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_44.pth
2021-06-15 02:50:00,058 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 45th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:51:22,851 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 45th epoch
        Time taken      : 1m 22.79s
        Training Loss   : 0.272213  |  Training Acc   : 88.2680%
        Validation Loss : 0.308052  |  Validation Acc : 86.4352%
===========================================================================

2021-06-15 02:51:22,851 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 46th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:52:45,323 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 46th epoch
        Time taken      : 1m 22.47s
        Training Loss   : 0.280680  |  Training Acc   : 87.7941%
        Validation Loss : 0.246971  |  Validation Acc : 89.5370%
===========================================================================

2021-06-15 02:52:45,324 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_46.pth
2021-06-15 02:52:45,582 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 47th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:54:07,560 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 47th epoch
        Time taken      : 1m 21.98s
        Training Loss   : 0.266753  |  Training Acc   : 88.8807%
        Validation Loss : 0.286318  |  Validation Acc : 88.1944%
===========================================================================

2021-06-15 02:54:07,560 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 48th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:55:29,919 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 48th epoch
        Time taken      : 1m 22.36s
        Training Loss   : 0.266128  |  Training Acc   : 88.9624%
        Validation Loss : 0.262249  |  Validation Acc : 88.9352%
===========================================================================

2021-06-15 02:55:29,919 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_48.pth
2021-06-15 02:55:30,191 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 49th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:56:53,192 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 49th epoch
        Time taken      : 1m 23.00s
        Training Loss   : 0.254742  |  Training Acc   : 89.6324%
        Validation Loss : 0.240751  |  Validation Acc : 90.4630%
===========================================================================

2021-06-15 02:56:53,192 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 50th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 02:58:16,407 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 50th epoch
        Time taken      : 1m 23.22s
        Training Loss   : 0.258590  |  Training Acc   : 89.3873%
        Validation Loss : 0.241301  |  Validation Acc : 90.6481%
===========================================================================

2021-06-15 02:58:16,407 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_50.pth
2021-06-15 02:58:19,085 : START
2021-06-15 02:58:19,117 : Global Device: cuda:1
2021-06-15 02:58:19,117 : Parsed Args: Namespace(base_dir='/repo/course/sem21_01/PCB-fault-classification/', base_model='plain_resnet101', batch_size=16, ckpt_path='/repo/course/sem21_01/PCB-fault-classification/ckpt/', cuda=True, data_type='original', device_index=1, epochs=50, fold_k=1, label_dir='/repo/course/sem21_01/PCB-fault-classification/label.csv', learning_rate=0.003, lr_type='multi', mode='test', model_index=52, patience=10, pretrained=False, pretrained_weights_dir='/repo/course/sem21_01/PCB-fault-classification/pretrained_model', seed=227182, test_ratio=0.2, threshold=0.0, tta=False, val_ratio=0.15, verbose=20, voting='hard')
2021-06-15 02:58:19,126 : Trainset(train+val) length: 2400, Testset length: 600
2021-06-15 02:58:19,187 : Trainset length: 2040, Valset length: 360
2021-06-15 02:58:19,677 : Not using pretrained model.
2021-06-15 02:58:23,386 : Inference using model of fold (1/1)
2021-06-15 02:58:23,591 : Inference on test_loader (1/1)
2021-06-15 02:58:38,925 : 
---------------------------------------------------------------------------
    SUMMARY
        Test Acc        : 45.6944%
===========================================================================

2021-06-15 02:58:38,925 : Done.
2021-06-15 02:58:38,928 : Result file save at: /repo/course/sem21_01/PCB-fault-classification/submit/submission_model_52.csv
2021-06-15 06:23:37,608 : START
2021-06-15 06:23:37,644 : Global Device: cuda:0
2021-06-15 06:23:37,644 : Parsed Args: Namespace(base_dir='/repo/course/sem21_01/PCB-fault-classification/', base_model='plain_resnet101', batch_size=16, ckpt_path='/repo/course/sem21_01/PCB-fault-classification/ckpt/', cuda=True, data_type='original', device_index=0, epochs=50, fold_k=1, label_dir='/repo/course/sem21_01/PCB-fault-classification/label.csv', learning_rate=0.003, lr_type='multi', mode='train', model_index=52, patience=10, pretrained=False, pretrained_weights_dir='/repo/course/sem21_01/PCB-fault-classification/pretrained_model', seed=227182, test_ratio=0.2, threshold=0.0, tta=False, val_ratio=0.15, verbose=20, voting='hard')
2021-06-15 06:23:37,655 : Trainset(train+val) length: 2400, Testset length: 600
2021-06-15 06:23:37,729 : Trainset length: 2040, Valset length: 360
2021-06-15 06:23:38,225 : Not using pretrained model.
2021-06-15 06:23:41,832 : Training on Fold (1/1)
2021-06-15 06:23:41,839 : 
                    ---------------------------------------------------------------------------
                        TRAINING INFO
                            Loss function : BCEWithLogitsLoss()
                            Optimizer     : RAdam (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.003
    lr: 0.003
    weight_decay: 0.0001
)
                            LR_Scheduler  : <torch.optim.lr_scheduler.MultiStepLR object at 0x7f745c25a748>
                    ---------------------------------------------------------------------------
2021-06-15 06:23:41,839 : Training begins... Epochs = 50
2021-06-15 06:23:41,839 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 1th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:25:02,332 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 1th epoch
        Time taken      : 1m 20.49s
        Training Loss   : 0.713469  |  Training Acc   : 55.0082%
        Validation Loss : 0.684021  |  Validation Acc : 59.4907%
===========================================================================

2021-06-15 06:25:02,332 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 2th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:26:21,881 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 2th epoch
        Time taken      : 1m 19.55s
        Training Loss   : 0.681795  |  Training Acc   : 57.4592%
        Validation Loss : 0.673851  |  Validation Acc : 60.0926%
===========================================================================

2021-06-15 06:26:21,881 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 3th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:27:42,891 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 3th epoch
        Time taken      : 1m 21.01s
        Training Loss   : 0.681813  |  Training Acc   : 57.5245%
        Validation Loss : 0.678070  |  Validation Acc : 59.2593%
===========================================================================

2021-06-15 06:27:42,892 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 4th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:29:04,317 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 4th epoch
        Time taken      : 1m 21.43s
        Training Loss   : 0.682317  |  Training Acc   : 56.9771%
        Validation Loss : 0.671753  |  Validation Acc : 60.0463%
===========================================================================

2021-06-15 06:29:04,317 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 5th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:30:25,706 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 5th epoch
        Time taken      : 1m 21.39s
        Training Loss   : 0.679596  |  Training Acc   : 57.8513%
        Validation Loss : 0.669145  |  Validation Acc : 59.6759%
===========================================================================

2021-06-15 06:30:25,706 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 6th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:31:47,072 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 6th epoch
        Time taken      : 1m 21.37s
        Training Loss   : 0.681555  |  Training Acc   : 57.3366%
        Validation Loss : 0.679250  |  Validation Acc : 59.8611%
===========================================================================

2021-06-15 06:31:47,072 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 7th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:33:08,419 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 7th epoch
        Time taken      : 1m 21.35s
        Training Loss   : 0.683436  |  Training Acc   : 57.4183%
        Validation Loss : 0.679596  |  Validation Acc : 59.8148%
===========================================================================

2021-06-15 06:33:08,419 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 8th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:34:29,043 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 8th epoch
        Time taken      : 1m 20.62s
        Training Loss   : 0.680580  |  Training Acc   : 58.0065%
        Validation Loss : 0.672416  |  Validation Acc : 60.0463%
===========================================================================

2021-06-15 06:34:29,043 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 9th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:35:50,742 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 9th epoch
        Time taken      : 1m 21.70s
        Training Loss   : 0.679031  |  Training Acc   : 58.0147%
        Validation Loss : 0.675209  |  Validation Acc : 59.9074%
===========================================================================

2021-06-15 06:35:50,743 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 10th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:37:12,391 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 10th epoch
        Time taken      : 1m 21.65s
        Training Loss   : 0.677874  |  Training Acc   : 58.1373%
        Validation Loss : 0.669216  |  Validation Acc : 60.2778%
===========================================================================

2021-06-15 06:37:12,391 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 11th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:38:34,431 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 11th epoch
        Time taken      : 1m 22.04s
        Training Loss   : 0.678412  |  Training Acc   : 58.0719%
        Validation Loss : 0.672970  |  Validation Acc : 59.9537%
===========================================================================

2021-06-15 06:38:34,431 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 12th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:39:56,162 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 12th epoch
        Time taken      : 1m 21.73s
        Training Loss   : 0.676524  |  Training Acc   : 58.1618%
        Validation Loss : 0.669913  |  Validation Acc : 60.3241%
===========================================================================

2021-06-15 06:39:56,162 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 13th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:41:17,633 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 13th epoch
        Time taken      : 1m 21.47s
        Training Loss   : 0.677179  |  Training Acc   : 58.2271%
        Validation Loss : 0.674334  |  Validation Acc : 59.8148%
===========================================================================

2021-06-15 06:41:17,633 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 14th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:42:39,199 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 14th epoch
        Time taken      : 1m 21.57s
        Training Loss   : 0.679408  |  Training Acc   : 58.1618%
        Validation Loss : 0.671165  |  Validation Acc : 59.7685%
===========================================================================

2021-06-15 06:42:39,199 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 15th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 06:44:00,313 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 15th epoch
        Time taken      : 1m 21.11s
        Training Loss   : 0.678663  |  Training Acc   : 57.9984%
        Validation Loss : 0.670943  |  Validation Acc : 59.8611%
===========================================================================

2021-06-15 06:44:00,313 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 16th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 06:45:21,622 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 16th epoch
        Time taken      : 1m 21.31s
        Training Loss   : 0.679310  |  Training Acc   : 57.9575%
        Validation Loss : 0.673356  |  Validation Acc : 59.6296%
===========================================================================

2021-06-15 06:45:21,622 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 17th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 06:46:43,147 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 17th epoch
        Time taken      : 1m 21.52s
        Training Loss   : 0.672806  |  Training Acc   : 58.4641%
        Validation Loss : 0.637867  |  Validation Acc : 66.3426%
===========================================================================

2021-06-15 06:46:43,147 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 18th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 06:48:04,606 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 18th epoch
        Time taken      : 1m 21.46s
        Training Loss   : 0.655861  |  Training Acc   : 59.2810%
        Validation Loss : 0.607768  |  Validation Acc : 62.5926%
===========================================================================

2021-06-15 06:48:04,606 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 19th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 06:49:25,771 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 19th epoch
        Time taken      : 1m 21.16s
        Training Loss   : 0.562796  |  Training Acc   : 68.1781%
        Validation Loss : 0.493974  |  Validation Acc : 76.3426%
===========================================================================

2021-06-15 06:49:25,771 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 20th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 06:50:47,095 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 20th epoch
        Time taken      : 1m 21.32s
        Training Loss   : 0.475648  |  Training Acc   : 75.3840%
        Validation Loss : 0.321905  |  Validation Acc : 84.3981%
===========================================================================

2021-06-15 06:50:47,095 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 21th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 06:52:08,190 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 21th epoch
        Time taken      : 1m 21.09s
        Training Loss   : 0.387634  |  Training Acc   : 80.6699%
        Validation Loss : 0.362430  |  Validation Acc : 83.0093%
===========================================================================

2021-06-15 06:52:08,190 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 22th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 06:53:28,852 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 22th epoch
        Time taken      : 1m 20.66s
        Training Loss   : 0.364202  |  Training Acc   : 82.8758%
        Validation Loss : 0.307341  |  Validation Acc : 84.2130%
===========================================================================

2021-06-15 06:53:28,853 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 23th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 06:54:50,286 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 23th epoch
        Time taken      : 1m 21.43s
        Training Loss   : 0.434976  |  Training Acc   : 80.0654%
        Validation Loss : 0.314143  |  Validation Acc : 85.8796%
===========================================================================

2021-06-15 06:54:50,286 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 24th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 06:56:11,363 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 24th epoch
        Time taken      : 1m 21.08s
        Training Loss   : 0.333971  |  Training Acc   : 84.8529%
        Validation Loss : 0.308898  |  Validation Acc : 85.6944%
===========================================================================

2021-06-15 06:56:11,363 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 25th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 06:57:32,486 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 25th epoch
        Time taken      : 1m 21.12s
        Training Loss   : 0.331584  |  Training Acc   : 84.9837%
        Validation Loss : 0.309727  |  Validation Acc : 86.8981%
===========================================================================

2021-06-15 06:57:32,486 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 26th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 06:58:53,707 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 26th epoch
        Time taken      : 1m 21.22s
        Training Loss   : 0.338659  |  Training Acc   : 84.6487%
        Validation Loss : 0.302891  |  Validation Acc : 86.5741%
===========================================================================

2021-06-15 06:58:53,708 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 27th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 07:00:15,217 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 27th epoch
        Time taken      : 1m 21.51s
        Training Loss   : 0.354011  |  Training Acc   : 83.9624%
        Validation Loss : 0.317538  |  Validation Acc : 85.0000%
===========================================================================

2021-06-15 07:00:15,218 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 28th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 07:01:35,854 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 28th epoch
        Time taken      : 1m 20.64s
        Training Loss   : 0.306796  |  Training Acc   : 85.8252%
        Validation Loss : 0.291623  |  Validation Acc : 87.2685%
===========================================================================

2021-06-15 07:01:35,854 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 29th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 07:02:57,209 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 29th epoch
        Time taken      : 1m 21.35s
        Training Loss   : 0.314874  |  Training Acc   : 85.7680%
        Validation Loss : 0.292425  |  Validation Acc : 85.7407%
===========================================================================

2021-06-15 07:02:57,209 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 30th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 07:04:18,113 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 30th epoch
        Time taken      : 1m 20.90s
        Training Loss   : 0.310878  |  Training Acc   : 86.2908%
        Validation Loss : 0.269858  |  Validation Acc : 88.2407%
===========================================================================

2021-06-15 07:04:18,114 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 31th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:05:39,583 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 31th epoch
        Time taken      : 1m 21.47s
        Training Loss   : 0.285132  |  Training Acc   : 87.8431%
        Validation Loss : 0.274733  |  Validation Acc : 87.3148%
===========================================================================

2021-06-15 07:05:39,583 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 32th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:07:00,471 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 32th epoch
        Time taken      : 1m 20.89s
        Training Loss   : 0.321025  |  Training Acc   : 85.8824%
        Validation Loss : 0.269313  |  Validation Acc : 88.4259%
===========================================================================

2021-06-15 07:07:00,471 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 33th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:08:21,372 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 33th epoch
        Time taken      : 1m 20.90s
        Training Loss   : 0.289663  |  Training Acc   : 87.6961%
        Validation Loss : 0.263825  |  Validation Acc : 88.9815%
===========================================================================

2021-06-15 07:08:21,372 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 34th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:09:42,662 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 34th epoch
        Time taken      : 1m 21.29s
        Training Loss   : 0.274216  |  Training Acc   : 88.5784%
        Validation Loss : 0.248047  |  Validation Acc : 90.3704%
===========================================================================

2021-06-15 07:09:42,662 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 35th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:11:03,567 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 35th epoch
        Time taken      : 1m 20.90s
        Training Loss   : 0.272370  |  Training Acc   : 88.3497%
        Validation Loss : 0.252316  |  Validation Acc : 89.6759%
===========================================================================

2021-06-15 07:11:03,568 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 36th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:12:24,556 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 36th epoch
        Time taken      : 1m 20.99s
        Training Loss   : 0.268311  |  Training Acc   : 88.7500%
        Validation Loss : 0.245251  |  Validation Acc : 89.6759%
===========================================================================

2021-06-15 07:12:24,557 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 37th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:13:46,067 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 37th epoch
        Time taken      : 1m 21.51s
        Training Loss   : 0.280470  |  Training Acc   : 87.9657%
        Validation Loss : 0.254126  |  Validation Acc : 89.8611%
===========================================================================

2021-06-15 07:13:46,067 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 38th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:15:06,979 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 38th epoch
        Time taken      : 1m 20.91s
        Training Loss   : 0.324812  |  Training Acc   : 89.0114%
        Validation Loss : 0.249884  |  Validation Acc : 89.5370%
===========================================================================

2021-06-15 07:15:06,979 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 39th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:16:28,199 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 39th epoch
        Time taken      : 1m 21.22s
        Training Loss   : 0.298744  |  Training Acc   : 87.4918%
        Validation Loss : 0.262978  |  Validation Acc : 89.4907%
===========================================================================

2021-06-15 07:16:28,199 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 40th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:17:49,631 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 40th epoch
        Time taken      : 1m 21.43s
        Training Loss   : 0.269735  |  Training Acc   : 88.7745%
        Validation Loss : 0.265778  |  Validation Acc : 89.6296%
===========================================================================

2021-06-15 07:17:49,632 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_40.pth
2021-06-15 07:17:50,650 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 41th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:19:11,320 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 41th epoch
        Time taken      : 1m 20.67s
        Training Loss   : 0.262677  |  Training Acc   : 89.4281%
        Validation Loss : 0.240224  |  Validation Acc : 90.3241%
===========================================================================

2021-06-15 07:19:11,320 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 42th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:20:32,397 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 42th epoch
        Time taken      : 1m 21.08s
        Training Loss   : 0.309861  |  Training Acc   : 86.4052%
        Validation Loss : 0.273598  |  Validation Acc : 88.4722%
===========================================================================

2021-06-15 07:20:32,397 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_42.pth
2021-06-15 07:20:33,189 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 43th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:21:54,160 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 43th epoch
        Time taken      : 1m 20.97s
        Training Loss   : 0.289834  |  Training Acc   : 88.1209%
        Validation Loss : 0.259792  |  Validation Acc : 89.4444%
===========================================================================

2021-06-15 07:21:54,160 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 44th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:23:15,377 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 44th epoch
        Time taken      : 1m 21.22s
        Training Loss   : 0.266308  |  Training Acc   : 89.2565%
        Validation Loss : 0.268719  |  Validation Acc : 89.2593%
===========================================================================

2021-06-15 07:23:15,377 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_44.pth
2021-06-15 07:23:15,948 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 45th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:24:36,681 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 45th epoch
        Time taken      : 1m 20.73s
        Training Loss   : 0.272213  |  Training Acc   : 88.2680%
        Validation Loss : 0.308052  |  Validation Acc : 86.4352%
===========================================================================

2021-06-15 07:24:36,682 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 46th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:25:58,550 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 46th epoch
        Time taken      : 1m 21.87s
        Training Loss   : 0.280680  |  Training Acc   : 87.7941%
        Validation Loss : 0.246971  |  Validation Acc : 89.5370%
===========================================================================

2021-06-15 07:25:58,550 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_46.pth
2021-06-15 07:25:59,133 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 47th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:27:20,229 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 47th epoch
        Time taken      : 1m 21.10s
        Training Loss   : 0.266753  |  Training Acc   : 88.8807%
        Validation Loss : 0.286318  |  Validation Acc : 88.1944%
===========================================================================

2021-06-15 07:27:20,229 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 48th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:28:41,079 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 48th epoch
        Time taken      : 1m 20.85s
        Training Loss   : 0.266128  |  Training Acc   : 88.9624%
        Validation Loss : 0.262249  |  Validation Acc : 88.9352%
===========================================================================

2021-06-15 07:28:41,079 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_48.pth
2021-06-15 07:28:41,625 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 49th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:30:03,720 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 49th epoch
        Time taken      : 1m 22.09s
        Training Loss   : 0.254742  |  Training Acc   : 89.6324%
        Validation Loss : 0.240751  |  Validation Acc : 90.4630%
===========================================================================

2021-06-15 07:30:03,720 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 50th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 07:31:25,570 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 50th epoch
        Time taken      : 1m 21.85s
        Training Loss   : 0.258590  |  Training Acc   : 89.3873%
        Validation Loss : 0.241301  |  Validation Acc : 90.6481%
===========================================================================

2021-06-15 07:31:25,570 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_52/model_ckpt_fold1_50.pth
2021-06-15 07:31:28,556 : START
2021-06-15 07:31:28,565 : Global Device: cuda:0
2021-06-15 07:31:28,565 : Parsed Args: Namespace(base_dir='/repo/course/sem21_01/PCB-fault-classification/', base_model='plain_resnet101', batch_size=16, ckpt_path='/repo/course/sem21_01/PCB-fault-classification/ckpt/', cuda=True, data_type='original', device_index=0, epochs=50, fold_k=1, label_dir='/repo/course/sem21_01/PCB-fault-classification/label.csv', learning_rate=0.003, lr_type='multi', mode='test', model_index=52, patience=10, pretrained=False, pretrained_weights_dir='/repo/course/sem21_01/PCB-fault-classification/pretrained_model', seed=227182, test_ratio=0.2, threshold=0.0, tta=False, val_ratio=0.15, verbose=20, voting='hard')
2021-06-15 07:31:28,574 : Trainset(train+val) length: 2400, Testset length: 600
2021-06-15 07:31:28,637 : Trainset length: 2040, Valset length: 360
2021-06-15 07:31:29,132 : Not using pretrained model.
2021-06-15 07:31:32,422 : Inference using model of fold (1/1)
2021-06-15 07:31:32,581 : Inference on test_loader (1/1)
2021-06-15 07:31:44,709 : 
---------------------------------------------------------------------------
    SUMMARY
        Test Acc        : 45.6944%
===========================================================================

2021-06-15 07:31:44,710 : Done.
2021-06-15 07:31:44,713 : Result file save at: /repo/course/sem21_01/PCB-fault-classification/submit/submission_model_52.csv
