2021-06-15 12:54:00,398 : START
2021-06-15 12:54:00,406 : Global Device: cuda:1
2021-06-15 12:54:00,406 : Parsed Args: Namespace(base_dir='/repo/course/sem21_01/PCB-fault-classification/', base_model='plain_efficientnetb4', batch_size=8, ckpt_path='/repo/course/sem21_01/PCB-fault-classification/ckpt/', cuda=True, data_type='original', device_index=1, epochs=50, fold_k=1, label_dir='/repo/course/sem21_01/PCB-fault-classification/label.csv', learning_rate=0.003, lr_type='multi', mode='train_ovr', model_index=66, patience=10, pretrained=False, pretrained_weights_dir='/repo/course/sem21_01/PCB-fault-classification/pretrained_model', seed=227182, test_ratio=0.2, threshold=0.0, tta=False, val_ratio=0.15, verbose=20, voting='hard')
2021-06-15 12:54:00,414 : Trainset(train+val) length: 2400, Testset length: 600
2021-06-15 12:54:00,476 : Trainset length: 2040, Valset length: 360
2021-06-15 12:54:00,714 : Not using pretrained model.
2021-06-15 12:54:04,241 : Training on Fold (1/1)
2021-06-15 12:54:04,265 : 
                    ---------------------------------------------------------------------------
                        TRAINING INFO
                            Loss function : BCEWithLogitsLoss()
                            Optimizer     : RAdam (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.003
    lr: 0.003
    weight_decay: 0.0001
)
                            LR_Scheduler  : <torch.optim.lr_scheduler.MultiStepLR object at 0x7fdd0b6e0ba8>
                    ---------------------------------------------------------------------------
2021-06-15 12:54:04,265 : Training begins... Epochs = 50
2021-06-15 12:54:04,265 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 1th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 12:56:10,415 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 1th epoch
        Time taken      : 2m 6.15s
        Training Loss   : 0.454523  |  Training Acc   : 77.9493%
        Validation Loss : 0.558286  |  Validation Acc : 79.3056%
===========================================================================

2021-06-15 12:56:10,416 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 2th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 12:58:20,587 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 2th epoch
        Time taken      : 2m 10.17s
        Training Loss   : 0.268284  |  Training Acc   : 89.6814%
        Validation Loss : 0.608157  |  Validation Acc : 79.3056%
===========================================================================

2021-06-15 12:58:20,587 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 3th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:00:27,055 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 3th epoch
        Time taken      : 2m 6.47s
        Training Loss   : 0.202899  |  Training Acc   : 92.8105%
        Validation Loss : 0.375298  |  Validation Acc : 88.9815%
===========================================================================

2021-06-15 13:00:27,056 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 4th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:02:32,505 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 4th epoch
        Time taken      : 2m 5.45s
        Training Loss   : 0.189763  |  Training Acc   : 93.2190%
        Validation Loss : 0.357455  |  Validation Acc : 87.5926%
===========================================================================

2021-06-15 13:02:32,505 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 5th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:04:38,410 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 5th epoch
        Time taken      : 2m 5.91s
        Training Loss   : 0.186976  |  Training Acc   : 93.5703%
        Validation Loss : 0.397915  |  Validation Acc : 87.8241%
===========================================================================

2021-06-15 13:04:38,411 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 6th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:06:44,120 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 6th epoch
        Time taken      : 2m 5.71s
        Training Loss   : 0.146008  |  Training Acc   : 95.2614%
        Validation Loss : 0.392799  |  Validation Acc : 88.7500%
===========================================================================

2021-06-15 13:06:44,120 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 7th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:08:49,972 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 7th epoch
        Time taken      : 2m 5.85s
        Training Loss   : 0.136909  |  Training Acc   : 95.3840%
        Validation Loss : 0.228637  |  Validation Acc : 93.6111%
===========================================================================

2021-06-15 13:08:49,973 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 8th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:10:56,068 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 8th epoch
        Time taken      : 2m 6.10s
        Training Loss   : 0.120208  |  Training Acc   : 96.1520%
        Validation Loss : 0.506251  |  Validation Acc : 85.0000%
===========================================================================

2021-06-15 13:10:56,069 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 9th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:13:01,620 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 9th epoch
        Time taken      : 2m 5.55s
        Training Loss   : 0.140128  |  Training Acc   : 95.4575%
        Validation Loss : 0.511800  |  Validation Acc : 87.5463%
===========================================================================

2021-06-15 13:13:01,620 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 10th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:15:07,705 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 10th epoch
        Time taken      : 2m 6.08s
        Training Loss   : 0.114877  |  Training Acc   : 96.2173%
        Validation Loss : 0.314680  |  Validation Acc : 91.2963%
===========================================================================

2021-06-15 13:15:07,705 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 11th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:17:13,661 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 11th epoch
        Time taken      : 2m 5.96s
        Training Loss   : 0.108226  |  Training Acc   : 96.5850%
        Validation Loss : 0.179579  |  Validation Acc : 94.7685%
===========================================================================

2021-06-15 13:17:13,662 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 12th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:19:19,626 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 12th epoch
        Time taken      : 2m 5.96s
        Training Loss   : 0.122293  |  Training Acc   : 96.1601%
        Validation Loss : 0.415687  |  Validation Acc : 87.6852%
===========================================================================

2021-06-15 13:19:19,626 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 13th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:21:25,364 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 13th epoch
        Time taken      : 2m 5.74s
        Training Loss   : 0.108845  |  Training Acc   : 96.6667%
        Validation Loss : 0.174652  |  Validation Acc : 95.2778%
===========================================================================

2021-06-15 13:21:25,365 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 14th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:23:31,779 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 14th epoch
        Time taken      : 2m 6.41s
        Training Loss   : 0.111792  |  Training Acc   : 96.3971%
        Validation Loss : 0.313727  |  Validation Acc : 91.6204%
===========================================================================

2021-06-15 13:23:31,779 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 15th epoch
        Learning Rate : 0.003000
---------------------------------------------------------------------------
2021-06-15 13:25:38,149 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 15th epoch
        Time taken      : 2m 6.37s
        Training Loss   : 0.094538  |  Training Acc   : 97.0588%
        Validation Loss : 0.419849  |  Validation Acc : 89.0741%
===========================================================================

2021-06-15 13:25:38,149 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 16th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 13:27:44,231 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 16th epoch
        Time taken      : 2m 6.08s
        Training Loss   : 0.061475  |  Training Acc   : 98.0147%
        Validation Loss : 0.268878  |  Validation Acc : 93.3333%
===========================================================================

2021-06-15 13:27:44,231 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 17th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 13:29:49,936 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 17th epoch
        Time taken      : 2m 5.70s
        Training Loss   : 0.054376  |  Training Acc   : 98.2680%
        Validation Loss : 0.199820  |  Validation Acc : 94.9074%
===========================================================================

2021-06-15 13:29:49,936 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 18th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 13:31:56,220 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 18th epoch
        Time taken      : 2m 6.28s
        Training Loss   : 0.041114  |  Training Acc   : 98.7745%
        Validation Loss : 0.198289  |  Validation Acc : 94.5370%
===========================================================================

2021-06-15 13:31:56,220 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 19th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 13:34:01,887 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 19th epoch
        Time taken      : 2m 5.67s
        Training Loss   : 0.053529  |  Training Acc   : 98.3088%
        Validation Loss : 0.313471  |  Validation Acc : 93.2407%
===========================================================================

2021-06-15 13:34:01,887 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 20th epoch
        Learning Rate : 0.002100
---------------------------------------------------------------------------
2021-06-15 13:36:08,136 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 20th epoch
        Time taken      : 2m 6.25s
        Training Loss   : 0.047314  |  Training Acc   : 98.5784%
        Validation Loss : 0.177163  |  Validation Acc : 95.6019%
===========================================================================

2021-06-15 13:36:08,136 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 21th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:38:14,624 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 21th epoch
        Time taken      : 2m 6.49s
        Training Loss   : 0.043118  |  Training Acc   : 98.7500%
        Validation Loss : 0.174591  |  Validation Acc : 95.5093%
===========================================================================

2021-06-15 13:38:14,624 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 22th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:40:20,465 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 22th epoch
        Time taken      : 2m 5.84s
        Training Loss   : 0.037169  |  Training Acc   : 98.9216%
        Validation Loss : 0.256095  |  Validation Acc : 94.5370%
===========================================================================

2021-06-15 13:40:20,465 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 23th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:42:26,236 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 23th epoch
        Time taken      : 2m 5.77s
        Training Loss   : 0.037248  |  Training Acc   : 98.8235%
        Validation Loss : 0.245519  |  Validation Acc : 93.8889%
===========================================================================

2021-06-15 13:42:26,237 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 24th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:44:32,756 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 24th epoch
        Time taken      : 2m 6.52s
        Training Loss   : 0.038280  |  Training Acc   : 98.8725%
        Validation Loss : 0.228449  |  Validation Acc : 93.9352%
===========================================================================

2021-06-15 13:44:32,756 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 25th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:46:38,562 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 25th epoch
        Time taken      : 2m 5.81s
        Training Loss   : 0.034080  |  Training Acc   : 98.9706%
        Validation Loss : 0.153862  |  Validation Acc : 95.9722%
===========================================================================

2021-06-15 13:46:38,562 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 26th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:48:44,240 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 26th epoch
        Time taken      : 2m 5.68s
        Training Loss   : 0.044101  |  Training Acc   : 98.7745%
        Validation Loss : 0.324034  |  Validation Acc : 91.2037%
===========================================================================

2021-06-15 13:48:44,240 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 27th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:50:50,182 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 27th epoch
        Time taken      : 2m 5.94s
        Training Loss   : 0.032818  |  Training Acc   : 98.9297%
        Validation Loss : 0.172707  |  Validation Acc : 96.0185%
===========================================================================

2021-06-15 13:50:50,183 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 28th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:52:56,157 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 28th epoch
        Time taken      : 2m 5.97s
        Training Loss   : 0.027349  |  Training Acc   : 99.2320%
        Validation Loss : 0.262307  |  Validation Acc : 93.8889%
===========================================================================

2021-06-15 13:52:56,157 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 29th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:55:02,411 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 29th epoch
        Time taken      : 2m 6.25s
        Training Loss   : 0.025383  |  Training Acc   : 99.3056%
        Validation Loss : 0.154249  |  Validation Acc : 95.6481%
===========================================================================

2021-06-15 13:55:02,411 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 30th epoch
        Learning Rate : 0.001470
---------------------------------------------------------------------------
2021-06-15 13:57:09,141 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 30th epoch
        Time taken      : 2m 6.73s
        Training Loss   : 0.043517  |  Training Acc   : 98.6438%
        Validation Loss : 0.333257  |  Validation Acc : 91.8519%
===========================================================================

2021-06-15 13:57:09,141 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 31th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 13:59:15,019 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 31th epoch
        Time taken      : 2m 5.88s
        Training Loss   : 0.028705  |  Training Acc   : 99.2239%
        Validation Loss : 0.132954  |  Validation Acc : 96.7593%
===========================================================================

2021-06-15 13:59:15,020 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 32th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:01:21,169 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 32th epoch
        Time taken      : 2m 6.15s
        Training Loss   : 0.025096  |  Training Acc   : 99.2320%
        Validation Loss : 0.170407  |  Validation Acc : 95.8333%
===========================================================================

2021-06-15 14:01:21,170 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 33th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:03:27,042 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 33th epoch
        Time taken      : 2m 5.87s
        Training Loss   : 0.018980  |  Training Acc   : 99.4526%
        Validation Loss : 0.165772  |  Validation Acc : 96.0185%
===========================================================================

2021-06-15 14:03:27,042 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 34th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:05:32,654 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 34th epoch
        Time taken      : 2m 5.61s
        Training Loss   : 0.017891  |  Training Acc   : 99.4363%
        Validation Loss : 0.162114  |  Validation Acc : 96.1111%
===========================================================================

2021-06-15 14:05:32,654 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 35th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:07:38,752 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 35th epoch
        Time taken      : 2m 6.10s
        Training Loss   : 0.018197  |  Training Acc   : 99.4935%
        Validation Loss : 0.177519  |  Validation Acc : 95.6481%
===========================================================================

2021-06-15 14:07:38,753 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 36th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:09:45,273 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 36th epoch
        Time taken      : 2m 6.52s
        Training Loss   : 0.026805  |  Training Acc   : 99.1748%
        Validation Loss : 0.211916  |  Validation Acc : 94.9537%
===========================================================================

2021-06-15 14:09:45,274 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 37th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:11:51,397 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 37th epoch
        Time taken      : 2m 6.12s
        Training Loss   : 0.018643  |  Training Acc   : 99.4690%
        Validation Loss : 0.182422  |  Validation Acc : 95.9722%
===========================================================================

2021-06-15 14:11:51,398 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 38th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:13:57,605 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 38th epoch
        Time taken      : 2m 6.21s
        Training Loss   : 0.016073  |  Training Acc   : 99.4853%
        Validation Loss : 0.142681  |  Validation Acc : 97.1296%
===========================================================================

2021-06-15 14:13:57,606 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 39th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:16:03,807 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 39th epoch
        Time taken      : 2m 6.20s
        Training Loss   : 0.017266  |  Training Acc   : 99.4363%
        Validation Loss : 0.188605  |  Validation Acc : 95.8333%
===========================================================================

2021-06-15 14:16:03,807 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 40th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:18:10,212 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 40th epoch
        Time taken      : 2m 6.40s
        Training Loss   : 0.015235  |  Training Acc   : 99.5588%
        Validation Loss : 0.150983  |  Validation Acc : 96.7130%
===========================================================================

2021-06-15 14:18:10,212 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_66/model_ckpt_fold1_40.pth
2021-06-15 14:18:10,327 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 41th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:20:16,166 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 41th epoch
        Time taken      : 2m 5.84s
        Training Loss   : 0.018371  |  Training Acc   : 99.5425%
        Validation Loss : 0.195073  |  Validation Acc : 95.8333%
===========================================================================

2021-06-15 14:20:16,167 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 42th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:22:22,669 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 42th epoch
        Time taken      : 2m 6.50s
        Training Loss   : 0.013665  |  Training Acc   : 99.6078%
        Validation Loss : 0.190672  |  Validation Acc : 96.4815%
===========================================================================

2021-06-15 14:22:22,669 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_66/model_ckpt_fold1_42.pth
2021-06-15 14:22:22,786 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 43th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:24:28,383 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 43th epoch
        Time taken      : 2m 5.60s
        Training Loss   : 0.018934  |  Training Acc   : 99.4690%
        Validation Loss : 0.175187  |  Validation Acc : 96.0185%
===========================================================================

2021-06-15 14:24:28,383 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 44th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:26:34,858 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 44th epoch
        Time taken      : 2m 6.47s
        Training Loss   : 0.015744  |  Training Acc   : 99.4771%
        Validation Loss : 0.283502  |  Validation Acc : 94.6296%
===========================================================================

2021-06-15 14:26:34,858 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_66/model_ckpt_fold1_44.pth
2021-06-15 14:26:34,975 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 45th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:28:40,889 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 45th epoch
        Time taken      : 2m 5.91s
        Training Loss   : 0.020867  |  Training Acc   : 99.3954%
        Validation Loss : 0.162592  |  Validation Acc : 96.3426%
===========================================================================

2021-06-15 14:28:40,889 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 46th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:30:46,929 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 46th epoch
        Time taken      : 2m 6.04s
        Training Loss   : 0.016547  |  Training Acc   : 99.5588%
        Validation Loss : 0.149312  |  Validation Acc : 96.9444%
===========================================================================

2021-06-15 14:30:46,929 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_66/model_ckpt_fold1_46.pth
2021-06-15 14:30:47,060 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 47th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:32:53,034 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 47th epoch
        Time taken      : 2m 5.97s
        Training Loss   : 0.019738  |  Training Acc   : 99.4363%
        Validation Loss : 0.165357  |  Validation Acc : 96.6204%
===========================================================================

2021-06-15 14:32:53,034 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 48th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:34:59,334 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 48th epoch
        Time taken      : 2m 6.30s
        Training Loss   : 0.021676  |  Training Acc   : 99.4036%
        Validation Loss : 0.149043  |  Validation Acc : 97.1759%
===========================================================================

2021-06-15 14:34:59,335 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_66/model_ckpt_fold1_48.pth
2021-06-15 14:34:59,448 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 49th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:37:05,751 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 49th epoch
        Time taken      : 2m 6.30s
        Training Loss   : 0.025075  |  Training Acc   : 99.2402%
        Validation Loss : 0.140772  |  Validation Acc : 96.4352%
===========================================================================

2021-06-15 14:37:05,751 : 
===========================================================================
    PHASE INFO
        Current fold  : Fold (1)
        Current phase : 50th epoch
        Learning Rate : 0.001029
---------------------------------------------------------------------------
2021-06-15 14:39:11,789 : 
---------------------------------------------------------------------------
    SUMMARY
        Finished phase  : 50th epoch
        Time taken      : 2m 6.04s
        Training Loss   : 0.013425  |  Training Acc   : 99.6650%
        Validation Loss : 0.233264  |  Validation Acc : 93.9352%
===========================================================================

2021-06-15 14:39:11,789 : SAVING MODEL: /repo/course/sem21_01/PCB-fault-classification/ckpt/model_66/model_ckpt_fold1_50.pth
2021-06-15 14:39:14,250 : START
2021-06-15 14:39:14,258 : Global Device: cuda:1
2021-06-15 14:39:14,258 : Parsed Args: Namespace(base_dir='/repo/course/sem21_01/PCB-fault-classification/', base_model='plain_efficientnetb4', batch_size=8, ckpt_path='/repo/course/sem21_01/PCB-fault-classification/ckpt/', cuda=True, data_type='original', device_index=1, epochs=50, fold_k=1, label_dir='/repo/course/sem21_01/PCB-fault-classification/label.csv', learning_rate=0.003, lr_type='multi', mode='test', model_index=66, patience=10, pretrained=False, pretrained_weights_dir='/repo/course/sem21_01/PCB-fault-classification/pretrained_model', seed=227182, test_ratio=0.2, threshold=0.0, tta=False, val_ratio=0.15, verbose=20, voting='hard')
2021-06-15 14:39:14,267 : Trainset(train+val) length: 2400, Testset length: 600
2021-06-15 14:39:14,331 : Trainset length: 2040, Valset length: 360
2021-06-15 14:39:14,564 : Not using pretrained model.
2021-06-15 14:39:18,005 : Inference using model of fold (1/1)
2021-06-15 14:39:18,193 : Inference on test_loader (1/1)
2021-06-15 14:39:36,538 : 
---------------------------------------------------------------------------
    SUMMARY
        Test Acc        : 98.4722%
===========================================================================

2021-06-15 14:39:36,538 : Done.
2021-06-15 14:39:36,542 : Result file save at: /repo/course/sem21_01/PCB-fault-classification/submit/submission_model_66.csv
